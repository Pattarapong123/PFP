<!-- src/views/home.ejs -->
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>PFP ENGINEERING</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/styles.css">
  <link rel="icon" type="image/jpeg" href="/images/logo2.jpg">

  <style>
    /* ===== Carousel Banner ===== */
    .carousel{
      position:relative; width:100%;
      height:calc(100vh - 68px);         /* ‡∏Å‡∏±‡∏ô‡∏ä‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ä‡∏ô navbar ‡∏ó‡∏µ‡πà fixed */
      min-height:420px;
      overflow:hidden; background:#000;
    }
    .carousel img{ width:100%; height:100%; object-fit:cover; object-position:center; display:none; }
    .carousel img.active{ display:block; }
    .carousel button{
      position:absolute; top:50%; transform:translateY(-50%);
      background:rgba(0,0,0,.45); color:#fff; border:0; padding:10px 14px;
      cursor:pointer; border-radius:50%; font-size:20px; z-index:2;
    }
    .carousel button:hover{ background:rgba(0,0,0,.6); }
    .carousel .prev{ left:20px; } .carousel .next{ right:20px; }
    .carousel-dots{ position:absolute; bottom:18px; left:50%; transform:translateX(-50%); display:flex; gap:8px; z-index:2; }
    .carousel-dots span{ width:10px; height:10px; border-radius:50%; background:rgba(255,255,255,.6); cursor:pointer; transition:background .2s; }
    .carousel-dots span.active{ background:#fff; }

    /* ===== Hero under banner ===== */
    .home-hero{ padding:34px 20px 28px; text-align:center; }

    /* ===== Our Projects ===== */
    .home-section{ padding: 10px 20px 40px; }
    .home-section .section-head{ text-align:center; margin: 0 auto 18px; max-width: 880px; }
    .home-section h2{ font-size: clamp(28px, 4vw, 44px); line-height:1.15; margin:0 0 8px; color:#102142; }
    .home-section p.lead{ color:var(--muted); margin:0; }

    .project-grid{
      display:grid;
      gap: 20px;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      align-items: stretch;
    }

    .project-card{
      position: relative;
      overflow: hidden;
      border-radius: 20px;
      background: #101629;
      color: #fff;
      min-height: 260px;                  
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      box-shadow: var(--shadow);
      isolation:isolate;                  
    }

    .project-card .cover{
      position:absolute; inset:0;
      width:100%; height:100%;
      object-fit:cover; object-position:center;
      filter: brightness(.78);
      transition: transform .35s ease, filter .35s ease;
      z-index:-1;
    }
    .project-card:hover .cover{ transform: scale(1.05); filter: brightness(.9); }

    .project-card .shade{
      position:absolute; inset:0;
      background: linear-gradient(180deg, rgba(0,0,0,.2), rgba(0,0,0,.65));
      z-index:0;
    }

    .project-card .content{ position:relative; z-index:1; padding: 20px; }

    .project-title{ font-size: 20px; font-weight: 800; margin: 0 0 6px; }
    .project-title a{ color:#fff; text-decoration:none; }
    .project-title a:hover{ text-decoration:underline; }

    .project-meta{ font-size: 14px; opacity:.85; }
    .project-actions{ margin-top: 10px; }

    /* ‡∏™‡∏≠‡∏á‡πÉ‡∏ö‡πÅ‡∏£‡∏Å‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
    .project-card.feature{ min-height: 300px; }

    /* ‡∏õ‡∏∏‡πà‡∏° CTA */
    .cta{ display:inline-flex; align-items:center; gap:8px; font-weight:800; border-radius:12px; padding:12px 16px; border:1px solid var(--border); text-decoration:none; }
    .cta--blue{ background:#2563eb; color:#fff; border-color:#1d4ed8; }
    .cta--blue:hover{ background:#1d4ed8; }
    .cta--lg{ padding: 12px 18px; border-radius:14px; }

    @media (max-width: 1100px){
      .project-card.feature{ min-height: 280px; }
    }
    @media (max-width: 720px){
      .carousel{ height: 52vh; min-height: 320px; }
      .project-title{ max-width: 100%; }
    }
  </style>
</head>
<body>

  <!-- Header -->
  <%- include('partials/header') %>

  <!-- üîπ Carousel Banner -->
  <section class="carousel" id="carousel">
    <img src="/images/logo1.jpg" class="active" alt="‡∏†‡∏≤‡∏û 1">
    <img src="/images/network.jpg" alt="‡∏†‡∏≤‡∏û 2">
    <img src="/images/test1.jpg" alt="‡∏†‡∏≤‡∏û 3">
    <img src="/images/test2.jpg" alt="‡∏†‡∏≤‡∏û 4">

    <button class="prev" aria-label="‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤">&#10094;</button>
    <button class="next" aria-label="‡∏ñ‡∏±‡∏î‡πÑ‡∏õ">&#10095;</button>

    <div class="carousel-dots" id="carouselDots"></div>
  </section>

  <!-- Intro -->
  <main class="container home-hero">
    <h1>‡πÇ‡∏ã‡∏•‡∏π‡∏ä‡∏±‡∏ô‡πÑ‡∏≠‡∏ó‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h1>
    <p style="margin:0 0 16px;color:var(--muted);">
      ‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô PFP ENGINEERING ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö ‡∏û‡∏±‡∏í‡∏ô‡∏≤ ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏≠‡∏ó‡∏µ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£
      ‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤
    </p>
    <div style="display:flex;gap:12px;flex-wrap:wrap;justify-content:center;">
      <!-- ‡∏•‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏≠‡∏≠‡∏Å ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô -->
      <a href="/contact" class="cta cta--blue cta--lg">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô</a>
    </div>
  </main>

  <!-- üîπ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ (‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å Portfolio) -->
  <section class="container home-section">
    <div class="section-head">
      <h2>‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</h2>
      <p class="lead">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö ‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ß‡∏á‡∏à‡∏£‡∏õ‡∏¥‡∏î ‡πÅ‡∏•‡∏∞‡πÇ‡∏ã‡∏•‡∏π‡∏ä‡∏±‡∏ô‡πÑ‡∏≠‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡πÑ‡∏ß‡πâ‡∏ß‡∏≤‡∏á‡πÉ‡∏à</p>
    </div>

    <div class="project-grid">
      <% if (Array.isArray(projects) && projects.length) { %>
        <% projects.forEach(function(p, idx){ 
             const cover =
               p.cover ||
               p.featuredImage ||
               (p.images && p.images[0] && p.images[0].url) ||
               '/images/placeholder.png';
        %>
          <article class="project-card <%= idx < 2 ? 'feature' : '' %>">
            <img class="cover" src="<%= cover %>" alt="<%= p.title %>" onerror="this.onerror=null;this.src='/images/placeholder.png';">
            <div class="shade" aria-hidden="true"></div>
            <div class="content">
              <div>
                <h3 class="project-title">
                  <a href="/portfolio/<%= p.slug %>"><%= p.title %></a>
                </h3>
                <% if (p.publishedAt) { %>
                  <div class="project-meta"><%= new Date(p.publishedAt).toLocaleDateString('th-TH') %></div>
                <% } %>
              </div>
              <div class="project-actions">
                <a class="btn btn--primary btn--sm btn--pill" href="/portfolio/<%= p.slug %>">‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</a>
              </div>
            </div>
          </article>
        <% }) %>
      <% } else { %>
        <div class="admin-empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á</div>
      <% } %>
    </div>

    <div style="text-align:center; margin-top:18px;">
      <a href="/portfolio" class="cta cta--blue cta--lg">‡∏î‡∏π‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a>
    </div>
  </section>

  <!-- Footer -->
  <%- include('partials/footer') %>

  <script>
    // ===== Carousel
    const carousel = document.getElementById("carousel");
    const images = carousel.querySelectorAll("img");
    const prevBtn = carousel.querySelector(".prev");
    const nextBtn = carousel.querySelector(".next");
    const dotsContainer = document.getElementById("carouselDots");
    let current = 0;

    images.forEach((_, i) => {
      const dot = document.createElement("span");
      dot.addEventListener("click", () => { current = i; showSlide(current); });
      dotsContainer.appendChild(dot);
    });
    const dots = dotsContainer.querySelectorAll("span");

    function showSlide(index){
      images.forEach((img,i)=> img.classList.toggle("active", i === index));
      dots.forEach((dot,i)=> dot.classList.toggle("active", i === index));
    }
    function nextSlide(){ current = (current + 1) % images.length; showSlide(current); }
    function prevSlide(){ current = (current - 1 + images.length) % images.length; showSlide(current); }

    nextBtn.addEventListener("click", nextSlide);
    prevBtn.addEventListener("click", prevSlide);
    let timer = setInterval(nextSlide, 5000);
    carousel.addEventListener('mouseenter', ()=> clearInterval(timer));
    carousel.addEventListener('mouseleave', ()=> timer = setInterval(nextSlide, 5000));

    showSlide(current);
  </script>
</body>
</html>
