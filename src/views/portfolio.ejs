<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title><%= (typeof title !== 'undefined' ? title : 'ผลงาน') %> - PFP ENGINEERING</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="ตัวอย่างผลงานติดตั้งระบบไฟฟ้า ตู้คอนโทรล ระบบเน็ตเวิร์ก และงานวิศวกรรมโดย PFP Engineering" />
  <link rel="stylesheet" href="/styles.css">

  <!-- Favicon -->
  <link rel="icon" type="image/jpeg" href="/image/logo2.jpg">

  <style>
    /* ============================
       HERO (เต็มขอบ + เผื่อระยะ header)
       ============================ */
    :root{ --header-h: 72px; } /* ปรับได้ถ้า header คุณสูง/ต่ำกว่านี้ */

    .pf-hero{
      position: relative;
      /* ทำให้ full-bleed จริงๆ ต่อให้วางใน .container */
      margin: 0 calc(50% - 50vw) 28px; /* ซ้าย/ขวาเต็มขอบ, ล่าง 28px */
      width: 100vw;

      min-height: clamp(240px, 32vw, 380px);
  /* ความสูงที่ดูพอดีทุกจอ */
      padding: calc(var(--header-h) + clamp(10px, 2vw, 24px)) 
               clamp(28px, 6vw, 80px) 
               clamp(28px, 6vw, 72px); 
      /*   ^ เผื่อระยะด้านบนกัน header ทับ */

      display: flex; align-items: flex-start; justify-content: center;
      flex-direction: column;

      background: url('/images/BG1.jpg') center/cover no-repeat;
      color:#fff; isolation:isolate; overflow:hidden;
    }
    .pf-hero::after{
      content:""; position:absolute; inset:0; z-index:-1;
      /* ม่านทับให้ตัวอักษรชัด แต่โปร่งกว่าเดิม */
      background:
        linear-gradient(90deg,
          rgba(5,10,25,.70) 0%,
          rgba(5,10,25,.52) 35%,
          rgba(5,10,25,.26) 70%,
          rgba(5,10,25,.14) 100%),
        linear-gradient(180deg, rgba(0,0,0,.12) 0%, rgba(0,0,0,.18) 100%);
    }

    .pf-hero .title{
      font-size: clamp(36px, 6vw, 72px);
      font-weight: 900; line-height:1.1; margin:0;
      text-shadow: 0 10px 34px rgba(0,0,0,.45);
    }
    .pf-hero .sub{
      margin-top: 12px; max-width: 720px;
      font-size: clamp(14px, 2vw, 18px); line-height:1.6; color:#f3f4f6;
    }

    /* ====== การ์ดผลงาน (คงเดิม) ====== */
    .project-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 22px;
    }
    @media (max-width: 1080px){
      .project-grid{ grid-template-columns: 1fr; }
    }

    .project-card{
      position: relative;
      display: grid;
      align-content: end;
      min-height: 300px;
      aspect-ratio: 16 / 9;
      border-radius: 18px;
      overflow: hidden;
      text-decoration: none;
      color: #fff;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
      background-color: #0b1220;
      isolation: isolate;
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease, filter .18s ease;
    }
    .project-card:hover{
      transform: translateY(-4px);
      box-shadow: 0 16px 36px rgba(16,24,40,.2);
      border-color: color-mix(in oklab, var(--primary) 30%, var(--border));
      filter: saturate(1.04);
    }
    .project-card::before{
      content:"";
      position: absolute; inset:0;
      background-image: var(--bg);
      background-size: cover; background-position: center;
      transform: scale(1.02);
      z-index: -2;
      transition: transform .4s ease;
    }
    .project-card:hover::before{ transform: scale(1.06); }
    .project-card::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(120% 120% at 20% 70%,
          rgba(2,6,23,.45) 0%,
          rgba(2,6,23,.55) 38%,
          rgba(2,6,23,.65) 64%,
          rgba(2,6,23,.78) 86%,
          rgba(2,6,23,.85) 100%),
        linear-gradient(180deg, rgba(2,6,23,0.35) 0%, rgba(2,6,23,0.65) 100%);
      z-index: -1;
    }
    .pc-wrap{
      padding: 26px 26px 24px;
      display:grid; gap: 14px;
      max-width: 680px;
    }
    .pc-title{
      font-size: clamp(18px, 2.2vw, 22px);
      font-weight: 900;
      line-height: 1.45;
      text-shadow: 0 6px 28px rgba(0,0,0,.45);
    }
    .pc-meta{ color: #c7d2fe; font-weight: 700; font-size: 13px; letter-spacing: .2px; }
    .pc-actions{ display:flex; gap:10px; align-items:center; }
    .pc-btn{
      display:inline-flex; align-items:center; justify-content:center;
      padding: 10px 16px; border-radius: 999px;
      color:#fff; background: rgba(59,130,246,.14);
      border:1px solid rgba(99,102,241,.35);
      font-weight:800; text-decoration:none;
      backdrop-filter: blur(2px);
      transition: background .18s ease, border-color .18s ease, transform .03s ease;
    }
    .project-card:hover .pc-btn{ background: rgba(99,102,241,.26); border-color: rgba(99,102,241,.55); }
    .pc-btn:active{ transform: translateY(1px); }

    .pc-badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius:999px;
      background: rgba(59,130,246,.16);
      border:1px solid rgba(147,197,253,.35);
      color:#e5edff; font-weight:800; font-size:12px; width:max-content;
    }

    /* การ์ด fallback แบบเก่า (เก็บไว้ครบ) */
    .work-grid{ display:none; }
  </style>
</head>
<body>

  <%- include('partials/header') %>

  <main class="container" style="padding:24px 0;">
    <!-- Hero (BG1.jpg เต็มขอบ + ไม่โดน header ทับ) -->
    <section class="pf-hero">
      <h1 class="title">ผลงานของเรา</h1>
      <p class="sub">
        รวมตัวอย่างงานติดตั้งระบบไฟฟ้า ตู้คอนโทรล ระบบเครือข่าย และงานวิศวกรรมที่ PFP Engineering ส่งมอบคุณภาพให้ลูกค้า
      </p>
    </section>

    <% if (!posts || posts.length === 0) { %>
      <section class="admin-card">
        <div class="admin-empty" style="padding:24px;">
          <div class="admin-skeleton" style="max-width: 360px;"></div>
          <div>ยังไม่มีผลงานที่เผยแพร่ในขณะนี้</div>
        </div>
      </section>
    <% } else { %>
      <!-- ===== NEW cards ===== -->
      <section class="project-grid">
        <% posts.forEach(post => { 
             const img = post.featuredImage || '/image/logo2.jpg';
        %>
          <a class="project-card" href="/portfolio/<%= post.slug %>" style="--bg:url('<%= img %>')">
            <div class="pc-wrap">
              <% if (post.category || post.tags?.length){ %>
                <span class="pc-badge"><%= post.category || post.tags[0] %></span>
              <% } %>

              <h3 class="pc-title"><%= post.title %></h3>

              <div class="pc-actions">
                <span class="pc-meta">PFP Engineering</span>
                <span style="flex:1 1 auto"></span>
                <span class="pc-btn">อ่านเพิ่มเติม</span>
              </div>
            </div>
          </a>
        <% }) %>
      </section>

      <!-- เก็บโค้ดเก่าไว้ -->
      <section class="work-grid">
        <% posts.forEach(post => { 
             const img = post.featuredImage || '/image/logo2.jpg';
        %>
          <article class="work-card">
            <div class="work-media">
              <a href="/portfolio/<%= post.slug %>">
                <img class="work-thumb" src="<%= img %>" alt="ภาพปก: <%= post.title %>">
              </a>
            </div>
            <div class="work-body">
              <h3 class="work-title">
                <a href="/portfolio/<%= post.slug %>"><%= post.title %></a>
              </h3>

              <% if (post.summary) { %>
                <p class="work-summary"><%= post.summary %></p>
              <% } else { %>
                <p class="work-summary muted">ยังไม่มีสรุปสั้นสำหรับงานนี้</p>
              <% } %>

              <div class="work-footer">
                <a class="btn btn--primary" href="/portfolio/<%= post.slug %>">ดูรายละเอียด</a>
                <span style="color:var(--muted); font-size:13px;">PFP Engineering</span>
              </div>
            </div>
          </article>
        <% }) %>
      </section>
    <% } %>
  </main>

  <%- include('partials/footer') %>
</body>
</html>
